<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>untitled-1 – Chuang Lab TMU</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../images/tmu-logo.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-1328d16024fb3741a6a12ba29620befe.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Chuang Lab TMU</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../module1/docs/index.qmd"> 
<span class="menu-text">Dengue Infection Data Module</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../module2/docs/index.qmd"> 
<span class="menu-text">Shared Socioeconomic Pathways Module</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../module3/docs/index.qmd"> 
<span class="menu-text">Zonal Statistics Earth Observation Module</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../module4/docs/index.qmd"> 
<span class="menu-text">Machine Learning Epidemiology Prediction Module</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<div id="b9784e54" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># %%</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Import basic libraries</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> shapely.geometry <span class="im">import</span> Point</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pycwt <span class="im">as</span> wavelet</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pycwt <span class="im">import</span> wct_significance</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pycwt <span class="im">import</span> helpers</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.dates <span class="im">as</span> mdates</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.signal <span class="im">import</span> detrend</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.ticker <span class="im">import</span> LogLocator, FormatStrFormatter</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Load dengue case data</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>global_dengue_national <span class="op">=</span> pd.read_csv(<span class="st">"/home/patwuch/Documents/projects/Chuang-Lab-TMU/dengue-infection-module/work/global/National_extract_V1_3.csv"</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>global_dengue_temporal <span class="op">=</span> pd.read_csv(<span class="st">"/home/patwuch/Documents/projects/Chuang-Lab-TMU/dengue-infection-module/work/global/Temporal_extract_V1_3.csv"</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>global_dengue_spatial <span class="op">=</span> pd.read_csv(<span class="st">"/home/patwuch/Documents/projects/Chuang-Lab-TMU/dengue-infection-module/work/global/Spatial_extract_V1_3.csv"</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(global_dengue_national))</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(global_dengue_temporal))</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(global_dengue_spatial))</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_110577/2639077365.py:23: DtypeWarning: Columns (2) have mixed types. Specify dtype option on import or set low_memory=False.
  global_dengue_temporal = pd.read_csv("/home/patwuch/Documents/projects/Chuang-Lab-TMU/dengue-infection-module/work/global/Temporal_extract_V1_3.csv")
/tmp/ipykernel_110577/2639077365.py:24: DtypeWarning: Columns (2) have mixed types. Specify dtype option on import or set low_memory=False.
  global_dengue_spatial = pd.read_csv("/home/patwuch/Documents/projects/Chuang-Lab-TMU/dengue-infection-module/work/global/Spatial_extract_V1_3.csv")</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>29873
2835022
2821791</code></pre>
</div>
</div>
<div id="37d9a24a" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>RES_PRIORITY <span class="op">=</span> [<span class="st">"Week"</span>, <span class="st">"Month"</span>, <span class="st">"Year"</span>]  <span class="co"># higher resolution first</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>RES_COLOR_MAP <span class="op">=</span> {<span class="st">"Week"</span>: <span class="st">"blue"</span>, <span class="st">"Month"</span>: <span class="st">"green"</span>, <span class="st">"Year"</span>: <span class="st">"orange"</span>}</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_all_countries(df, output_dir, start_date<span class="op">=</span><span class="st">"2000-01-01"</span>):</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.copy()</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    start_date <span class="op">=</span> pd.to_datetime(start_date)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure date columns are datetime</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> [<span class="st">"calendar_start_date"</span>, <span class="st">"calendar_end_date"</span>]:</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>        df[col] <span class="op">=</span> pd.to_datetime(df[col], errors<span class="op">=</span><span class="st">"coerce"</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    output_dir <span class="op">=</span> Path(output_dir)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    output_dir.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    countries <span class="op">=</span> df[<span class="st">"full_name"</span>].dropna().unique()</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> country <span class="kw">in</span> countries:</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>        country_df <span class="op">=</span> df[df[<span class="st">"full_name"</span>] <span class="op">==</span> country].copy()</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>        country_df <span class="op">=</span> country_df.dropna(subset<span class="op">=</span>[<span class="st">"calendar_start_date"</span>, <span class="st">"calendar_end_date"</span>])</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> country_df.empty <span class="kw">or</span> country_df[<span class="st">"calendar_end_date"</span>].<span class="bu">max</span>() <span class="op">&lt;</span> start_date:</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Clip start date</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>        country_df <span class="op">=</span> country_df[country_df[<span class="st">"calendar_end_date"</span>] <span class="op">&gt;=</span> start_date]</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Expand to daily pseudo-cases with T_res</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>        country_df[<span class="st">"start_clipped"</span>] <span class="op">=</span> country_df[<span class="st">"calendar_start_date"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">max</span>(x, start_date))</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>        country_df[<span class="st">"date"</span>] <span class="op">=</span> country_df.<span class="bu">apply</span>(</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>            <span class="kw">lambda</span> r: pd.date_range(r[<span class="st">"start_clipped"</span>], r[<span class="st">"calendar_end_date"</span>], freq<span class="op">=</span><span class="st">"D"</span>)</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> r[<span class="st">"calendar_end_date"</span>] <span class="op">&gt;=</span> r[<span class="st">"start_clipped"</span>] <span class="cf">else</span> pd.DatetimeIndex([]),</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>            axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>        country_df[<span class="st">"n_days"</span>] <span class="op">=</span> country_df[<span class="st">"date"</span>].<span class="bu">str</span>.<span class="bu">len</span>()</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>        country_df[<span class="st">"daily_cases"</span>] <span class="op">=</span> country_df[<span class="st">"dengue_total"</span>] <span class="op">/</span> country_df[<span class="st">"n_days"</span>]</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Explode</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>        daily_df <span class="op">=</span> country_df[[<span class="st">"date"</span>, <span class="st">"daily_cases"</span>, <span class="st">"T_res"</span>]].explode(<span class="st">"date"</span>)</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> daily_df.empty:</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Normalize T_res</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>        daily_df[<span class="st">"T_res"</span>] <span class="op">=</span> daily_df[<span class="st">"T_res"</span>].astype(<span class="bu">str</span>).<span class="bu">str</span>.lower().<span class="bu">str</span>.strip()</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>        <span class="co"># -------------------------</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># For each date, pick highest resolution available</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># -------------------------</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>        daily_df[<span class="st">"res_priority"</span>] <span class="op">=</span> daily_df[<span class="st">"T_res"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: RES_PRIORITY.index(x) <span class="cf">if</span> x <span class="kw">in</span> RES_PRIORITY <span class="cf">else</span> <span class="bu">len</span>(RES_PRIORITY))</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>        daily_df <span class="op">=</span> daily_df.sort_values([<span class="st">"date"</span>, <span class="st">"res_priority"</span>])</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>        daily_df <span class="op">=</span> daily_df.drop_duplicates(<span class="st">"date"</span>, keep<span class="op">=</span><span class="st">"first"</span>)</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>        daily_df <span class="op">=</span> daily_df.sort_values(<span class="st">"date"</span>)  <span class="co"># final daily_df is continuous</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check for overlapping resolutions in the raw data</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>        raw_overlaps <span class="op">=</span> daily_df.groupby(<span class="st">"date"</span>)[<span class="st">"T_res"</span>].nunique()</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>        overlap_dates <span class="op">=</span> raw_overlaps[raw_overlaps <span class="op">&gt;</span> <span class="dv">1</span>].index</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(overlap_dates) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"WARNING: </span><span class="sc">{</span><span class="bu">len</span>(overlap_dates)<span class="sc">}</span><span class="ss"> dates had multiple resolutions for </span><span class="sc">{</span>country<span class="sc">}</span><span class="ss">. First 10: </span><span class="sc">{</span><span class="bu">list</span>(overlap_dates[:<span class="dv">10</span>])<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Compute cumulative cases</span></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>        daily_df[<span class="st">"cumulative_cases"</span>] <span class="op">=</span> daily_df[<span class="st">"daily_cases"</span>].cumsum()</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>        <span class="co"># -------------------------</span></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Helper to plot continuous line segments colored by resolution</span></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>        <span class="co"># -------------------------</span></span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> plot_colored_line(ax, x, y, res_series):</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>            start_idx <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>            <span class="cf">while</span> start_idx <span class="op">&lt;</span> <span class="bu">len</span>(x):</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>                current_res <span class="op">=</span> res_series.iloc[start_idx]</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>                <span class="co"># find contiguous segment with same resolution</span></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>                end_idx <span class="op">=</span> start_idx <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>                <span class="cf">while</span> end_idx <span class="op">&lt;</span> <span class="bu">len</span>(x) <span class="kw">and</span> res_series.iloc[end_idx] <span class="op">==</span> current_res:</span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>                    end_idx <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>                ax.plot(x[start_idx:end_idx], y[start_idx:end_idx],</span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>                        color<span class="op">=</span>RES_COLOR_MAP.get(current_res, <span class="st">"black"</span>),</span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>                        linewidth<span class="op">=</span><span class="fl">1.5</span>,</span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>                        alpha<span class="op">=</span><span class="fl">0.9</span> <span class="cf">if</span> current_res <span class="op">!=</span> <span class="st">"year"</span> <span class="cf">else</span> <span class="fl">0.6</span>)</span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>                start_idx <span class="op">=</span> end_idx</span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>        <span class="co"># -------------------------</span></span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Plot daily + cumulative in subplots</span></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>        <span class="co"># -------------------------</span></span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>        fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>), sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>        plot_colored_line(ax1, daily_df[<span class="st">"date"</span>], daily_df[<span class="st">"daily_cases"</span>], daily_df[<span class="st">"T_res"</span>])</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>        ax1.set_ylabel(<span class="st">"Daily Cases"</span>)</span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>        ax1.set_title(<span class="ss">f"Dengue Cases in </span><span class="sc">{</span>country<span class="sc">}</span><span class="ss"> (2000–present)"</span>)</span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>        plot_colored_line(ax2, daily_df[<span class="st">"date"</span>], daily_df[<span class="st">"cumulative_cases"</span>], daily_df[<span class="st">"T_res"</span>])</span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>        ax2.set_ylabel(<span class="st">"Cumulative Cases"</span>)</span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>        ax2.set_xlabel(<span class="st">"Date"</span>)</span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Build a shared legend</span></span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a>        handles <span class="op">=</span> [plt.Line2D([<span class="dv">0</span>], [<span class="dv">0</span>], color<span class="op">=</span>color, lw<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span>res.capitalize())</span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">for</span> res, color <span class="kw">in</span> RES_COLOR_MAP.items() <span class="cf">if</span> res <span class="kw">in</span> daily_df[<span class="st">"T_res"</span>].values]</span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> handles:</span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a>            fig.legend(handles<span class="op">=</span>handles, title<span class="op">=</span><span class="st">"Time Resolution"</span>, loc<span class="op">=</span><span class="st">"upper center"</span>, ncol<span class="op">=</span><span class="bu">len</span>(handles))</span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>        fig.tight_layout(rect<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.95</span>])</span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a>        fig.savefig(output_dir <span class="op">/</span> <span class="ss">f"</span><span class="sc">{</span>country<span class="sc">}</span><span class="ss">_dengue_plot.png"</span>, dpi<span class="op">=</span><span class="dv">300</span>)</span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>        plt.close(fig)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="fd3d4be9" class="cell" data-execution_count="44">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>plot_all_countries(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    df<span class="op">=</span>global_dengue_national,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    output_dir<span class="op">=</span><span class="st">"figures/dengue_national"</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="9be230cc" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>global_dengue_spatial</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">adm_0_name</th>
<th data-quarto-table-cell-role="th">adm_1_name</th>
<th data-quarto-table-cell-role="th">adm_2_name</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">ISO_A0</th>
<th data-quarto-table-cell-role="th">FAO_GAUL_code</th>
<th data-quarto-table-cell-role="th">RNE_iso_code</th>
<th data-quarto-table-cell-role="th">IBGE_code</th>
<th data-quarto-table-cell-role="th">calendar_start_date</th>
<th data-quarto-table-cell-role="th">calendar_end_date</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">dengue_total</th>
<th data-quarto-table-cell-role="th">case_definition_standardised</th>
<th data-quarto-table-cell-role="th">S_res</th>
<th data-quarto-table-cell-role="th">T_res</th>
<th data-quarto-table-cell-role="th">UUID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>AFGHANISTAN</td>
<td>NaN</td>
<td>NaN</td>
<td>AFGHANISTAN</td>
<td>AFG</td>
<td>1011446</td>
<td>AFG</td>
<td>NaN</td>
<td>2021-09-05</td>
<td>2021-09-11</td>
<td>2021</td>
<td>18.0</td>
<td>Suspected</td>
<td>Admin0</td>
<td>Week</td>
<td>WHOEMRO-ALL-2021-Y01-05</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>AFGHANISTAN</td>
<td>NaN</td>
<td>NaN</td>
<td>AFGHANISTAN</td>
<td>AFG</td>
<td>1011446</td>
<td>AFG</td>
<td>NaN</td>
<td>2021-09-12</td>
<td>2021-09-18</td>
<td>2021</td>
<td>24.0</td>
<td>Suspected</td>
<td>Admin0</td>
<td>Week</td>
<td>WHOEMRO-ALL-2021-Y01-05</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>AFGHANISTAN</td>
<td>NaN</td>
<td>NaN</td>
<td>AFGHANISTAN</td>
<td>AFG</td>
<td>1011446</td>
<td>AFG</td>
<td>NaN</td>
<td>2021-09-19</td>
<td>2021-09-25</td>
<td>2021</td>
<td>9.0</td>
<td>Suspected</td>
<td>Admin0</td>
<td>Week</td>
<td>WHOEMRO-ALL-2021-Y01-05</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>AFGHANISTAN</td>
<td>NaN</td>
<td>NaN</td>
<td>AFGHANISTAN</td>
<td>AFG</td>
<td>1011446</td>
<td>AFG</td>
<td>NaN</td>
<td>2021-09-26</td>
<td>2021-10-02</td>
<td>2021</td>
<td>104.0</td>
<td>Suspected</td>
<td>Admin0</td>
<td>Week</td>
<td>WHOEMRO-ALL-2021-Y01-05</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>AFGHANISTAN</td>
<td>NaN</td>
<td>NaN</td>
<td>AFGHANISTAN</td>
<td>AFG</td>
<td>1011446</td>
<td>AFG</td>
<td>NaN</td>
<td>2021-10-03</td>
<td>2021-10-09</td>
<td>2021</td>
<td>98.0</td>
<td>Suspected</td>
<td>Admin0</td>
<td>Week</td>
<td>WHOEMRO-ALL-2021-Y01-05</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2821786</th>
<td>YEMEN</td>
<td>NaN</td>
<td>NaN</td>
<td>YEMEN</td>
<td>YEM</td>
<td>269</td>
<td>YEM</td>
<td>NaN</td>
<td>2024-06-23</td>
<td>2024-06-29</td>
<td>2024</td>
<td>139.0</td>
<td>Suspected and confirmed</td>
<td>Admin0</td>
<td>Week</td>
<td>LITERATURE-YEM-20202024-Y01-00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2821787</th>
<td>YEMEN</td>
<td>NaN</td>
<td>NaN</td>
<td>YEMEN</td>
<td>YEM</td>
<td>269</td>
<td>YEM</td>
<td>NaN</td>
<td>2024-06-30</td>
<td>2024-07-06</td>
<td>2024</td>
<td>124.0</td>
<td>Suspected and confirmed</td>
<td>Admin0</td>
<td>Week</td>
<td>LITERATURE-YEM-20202024-Y01-00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2821788</th>
<td>YEMEN</td>
<td>NaN</td>
<td>NaN</td>
<td>YEMEN</td>
<td>YEM</td>
<td>269</td>
<td>YEM</td>
<td>NaN</td>
<td>2024-07-07</td>
<td>2024-07-13</td>
<td>2024</td>
<td>121.0</td>
<td>Suspected and confirmed</td>
<td>Admin0</td>
<td>Week</td>
<td>LITERATURE-YEM-20202024-Y01-00</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2821789</th>
<td>YEMEN</td>
<td>NaN</td>
<td>NaN</td>
<td>YEMEN</td>
<td>YEM</td>
<td>269</td>
<td>YEM</td>
<td>NaN</td>
<td>2024-07-14</td>
<td>2024-07-20</td>
<td>2024</td>
<td>121.0</td>
<td>Suspected and confirmed</td>
<td>Admin0</td>
<td>Week</td>
<td>LITERATURE-YEM-20202024-Y01-00</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2821790</th>
<td>YEMEN</td>
<td>NaN</td>
<td>NaN</td>
<td>YEMEN</td>
<td>YEM</td>
<td>269</td>
<td>YEM</td>
<td>NaN</td>
<td>2024-07-21</td>
<td>2024-07-27</td>
<td>2024</td>
<td>167.0</td>
<td>Suspected and confirmed</td>
<td>Admin0</td>
<td>Week</td>
<td>LITERATURE-YEM-20202024-Y01-00</td>
</tr>
</tbody>
</table>

<p>2821791 rows × 16 columns</p>
</div>
</div>
</div>
<div id="26288c0d" class="cell" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>global_dengue_national[<span class="st">'S_res'</span>].value_counts(), global_dengue_national[<span class="st">'T_res'</span>].value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>(S_res
 Admin0    29873
 Name: count, dtype: int64,
 T_res
 Week     23248
 Year      3495
 Month     3130
 Name: count, dtype: int64)</code></pre>
</div>
</div>
<div id="84d54e0a" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>global_dengue_spatial[<span class="st">'T_res'</span>].value_counts(), global_dengue_spatial[<span class="st">'S_res'</span>].value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>(T_res
 Week     2238858
 Month     575981
 Year        6952
 Name: count, dtype: int64,
 S_res
 Admin2    2642778
 Admin1     142245
 Admin0      36768
 Name: count, dtype: int64)</code></pre>
</div>
</div>
<div id="09497176" class="cell" data-execution_count="19">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>global_dengue_temporal[<span class="st">'T_res'</span>].value_counts(), global_dengue_temporal[<span class="st">'S_res'</span>].value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>(T_res
 Week     2249270
 Month     578429
 Year        7323
 Name: count, dtype: int64,
 S_res
 Admin2    2642777
 Admin1     151794
 Admin0      40451
 Name: count, dtype: int64)</code></pre>
</div>
</div>
<div id="64c220de" class="cell" data-execution_count="27">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>global_dengue_temporal[<span class="st">'adm_1_name'</span>].unique()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>array([nan, 'CORRIENTES', 'FORMOSA', 'SANTA FE', 'MISIONES', 'CHACO',
       'SALTA', 'SANTIAGO DEL ESTERO', 'BUENOS AIRES', 'JUJUY', 'CORDOBA',
       'TUCUMAN', 'ENTRE RIOS', 'LA RIOJA', 'MENDOZA', 'NEUQUEN',
       'CATAMARCA', 'SAN LUIS', 'RIO NEGRO', 'TIERRA DEL FUEGO',
       'LA PAMPA', 'SAN JUAN', 'SANTA CRUZ', 'CHUBUT', 'ACT', 'NSW', 'NT',
       'QLD', 'SA', 'TAS', 'VIC', 'WA', 'TRASHIYANGTSE',
       'WANGDUEPHODRANG', 'ZHEMGANG', 'MONGAR', 'PARO', 'PEMAGATSEL',
       'PUNAKHA', 'SAMTSE', 'SARPANG', 'SAMDRUPJONGKHAR', 'BUMTHANG',
       'CHUKHA', 'DAGANA', 'GASA', 'HAA', 'LHUNTSE', 'THIMPU', 'TRONGSA',
       'TSIRANG', 'TRASHIGANG', 'CHUQUISACA', 'LA PAZ', 'COCHABAMBA',
       'ORURO', 'POTOSI', 'TARIJA', 'BENI', 'PANDO', 'ALAGOAS', 'AMAPA',
       'ACRE', 'GOIAS', 'MINAS GERAIS', 'PARA', 'BAHIA', 'PERNAMBUCO',
       'MARANHAO', 'CEARA', 'RIO GRANDE DO NORTE', 'PIAUI', 'SAO PAULO',
       'PARANA', 'ESPIRITO SANTO', 'MATO GROSSO', 'PARAIBA',
       'MATO GROSSO DO SUL', 'TOCANTINS', 'RONDONIA', 'RORAIMA',
       'RIO GRANDE DO SUL', 'AMAZONAS', 'RIO DE JANEIRO', 'SERGIPE',
       'SANTA CATARINA', 'DISTRITO FEDERAL', 'BRUNEI MUARA DISTRICT',
       'TUTONG DISTRICT', 'TEMBURONG DISTRICT', 'BELAIT DISTRICT',
       'BANTEAY MEANCHEY', 'BATTAMBANG', 'KAMPONG CHAM',
       'KAMPONG CHHNANG', 'KAMPONG SPEU', 'KAMPONG THOM', 'KAMPOT',
       'KANDAL', 'KEP', 'KOH KONG', 'KRATIE', 'MONDUL KIRI',
       'OTDAR MEANCHEY', 'PAILIN', 'PHNOM PENH', 'PREAH SIHANOUK',
       'PREAH VIHEAR', 'PREY VENG', 'PURSAT', 'RATANAK KIRI', 'SIEM REAP',
       'STUNG TRENG', 'SVAY RIENG', 'TAKEO', 'GUANGDONG', 'HAINAN',
       'ANHUI SHENG', 'BEIJING SHI', 'CHONGQING SHI', 'FUJIAN SHENG',
       'GANSU SHENG', 'GUANGDONG SHENG', 'GUANGXI ZHUANGZU ZIZHIQU',
       'GUIZHOU SHENG', 'HAINAN SHENG', 'HEBEI SHENG',
       'HEILONGJIANG SHENG', 'HENAN SHENG', 'HUBEI SHENG', 'HUNAN SHENG',
       'JIANGSU SHENG', 'JIANGXI SHENG', 'JILIN SHENG', 'LIAONING SHENG',
       'NEI MONGOL ZIZHIQU', 'NINGXIA HUIZU ZIZHIQU', 'QINGHAI SHENG',
       'SHAANXI SHENG', 'SHANDONG SHENG', 'SHANGHAI SHI', 'SICHUAN SHENG',
       'TIANJIN SHI', 'XINJIANG UYGUR ZIZHIQU', 'XIZANG ZIZHIQU',
       'YUNNAN SHENG', 'ZHEJIANG SHENG', 'FUJIAN', 'ZHEJIANG', 'YUNNAN',
       'GUANGXI', 'HENAN', 'CHONGQING', 'HUBEI', 'HUNAN', 'SICHUAN',
       'SHANDONG', 'BEIJING', 'JIANGSU', 'ANHUI', 'SHANGHAI', 'GUNAGXI',
       'JIANGXI', 'CESAR', 'CAQUETA', 'BLIVAR', 'ANTIOQUIA', 'CHOCO',
       'CARTAGENA', 'BOGOTA', 'ARAUCA', 'CASANARE', 'BOYACA', 'ATLANTICO',
       'CUNDIMARCA', 'CAUCA', 'CALDAS', 'BARRANQUILLA', 'GUAINIA',
       'GUAVIARE', 'HUILA', 'LA GUAJIRA', 'MAGDALENA', 'META', 'NARINO',
       'NORTE DE SANTANDER', 'PUTUMAYO', 'QUINDIO', 'RISARALDA',
       'SAN ANDRES', 'SANTA MARTA', 'SUCRE', 'VAUPES', 'SANTANDER',
       'VICHADA', 'TOLIMA', 'VALLE', 'BOLIVAR', 'CUNDINAMARCA',
       'SAN ANDRES Y PROVIDENCIA', 'VALLE DEL CAUCA', 'GUAJIRA',
       'NORTE SANTANDER', 'ALAJUELA', 'CARTAGO', 'GUANACASTE', 'HEREDIA',
       'LIMON', 'PUNTARENAS', 'SAN JOSE', 'CAMAGUEY', 'CIEGO DE AVILA',
       'CIENFUEGOS', 'GRANMA', 'GUANTANAMO', 'HOLGUIN',
       'ISLA DE LA JUVENTUD', 'LA HABANA', 'LAS TUNAS', 'MATANZAS',
       'PINAR DEL RIO', 'SANCTI SPIRITUS', 'SANTIAGO DE CUBA',
       'VILLA CLARA', 'DISTRITO NACIONAL', 'AZUA', 'BAORUCO', 'BARAHONA',
       'DAJABON', 'DUARTE', 'ELIAS PINA', 'EL SEIBO', 'ESPAILLAT',
       'INDEPENDENCIA', 'LA ALTAGRACIA', 'LA ROMANA', 'LA VEGA',
       'MARIA TRINIDAD SANCHEZ', 'MONTE CRISTI', 'PEDERNALES', 'PERAVIA',
       'PUERTO PLATA', 'HERMANAS MIRABAL', 'SAMANA', 'SAN CRISTOBAL',
       'SAN PEDRO DE MACORIS', 'SANCHEZ RAMIREZ', 'SANTIAGO',
       'SANTIAGO. RODRIGUEZ', 'VALVERDE', 'MONSENOR NOUEL', 'MONTE PLATA',
       'HATO MAYOR', 'SAN JOSE DE OCOA', 'SANTO DOMINGO', 'SALCEDO',
       'MARIA TRINIDAD SANCHES', 'SANTIAGO RODRIGUEZ', 'GUAYAS', 'MANABI',
       'LOS RIOS', 'EL ORO', 'ESMERALDAS', 'CARCHI', 'IMBABURA',
       'PICHINCHA', 'COTOPAXI', 'TUNGURAHUA', 'CHIMBORAZO', 'CANAR',
       'AZUAY', 'LOJA', 'SUCUMBIOS', 'NAPO', 'ORELLANA', 'PASTAZA',
       'MORONA SANTIAGO', 'ZAMORA CHINCHIPE', 'SANTA ELENA', 'GALAPAGOS',
       'SANTO DOMINGO DE LOS TSACHILAS', 'ZAMORA CHINCIPE', 'AHUACHAPAN',
       'CABANAS', 'CHALATENANGO', 'CUSCATLAN', 'LA LIBERTAD', 'LA UNION',
       'MORAZAN', 'SAN MIGUEL', 'SAN VICENTE', 'SANTA ANA', 'SONSONATE',
       'USULUTAN', 'SAN SALVADOR', 'GUATEMALA', 'EL PROGRESO',
       'SACATEPEQUEZ', 'CHIMALTENANGO', 'ESCUINTLA', 'SANTA ROSA',
       'SOLOLA', 'TOTONICAPAN', 'QUETZALTENANGO', 'SUCHITEPEQUEZ',
       'RETALHULEU', 'SAN MARCOS', 'HUEHUETENANGO', 'QUICHE',
       'BAJA VERAPAZ', 'ALTA VERAPAZ', 'PETEN', 'IZABAL', 'ZACAPA',
       'CHIQUIMULA', 'JALAPA', 'JUTIAPA', 'GUATEMALA CENTRAL',
       'PETEN NORTE', 'PETEN SUR OCCIDENTAL', 'EL QUICHE',
       'PETEN SUR ORIENTAL', 'GUATEMALA NOR OCCIDENTE', 'IXCAN',
       'GUATEMALA SUR', 'GUATEMALA NOR ORIENTE', 'PETEN SURORIENTAL',
       'PETEN SUROCCIDENTAL', 'GUATEMALA NOROCCIDENTE',
       'GUATEMALA NORORIENTE', 'IXIL', 'CHANDIGARH', 'DELHI', 'GOA',
       'ANDHRA PRADESH', 'HARYANA', 'KARNATAKA', 'KERALA', 'GUJARAT',
       'PONDICHERRY', 'PUNJAB', 'RAJASTHAN', 'MAHARASHTRA',
       'UTTAR PRADESH', 'TAMIL NADU', 'WEST BENGAL', 'MADHYA PRADESH',
       'MANIPUR', 'ARUNACHAL\r\nPRADESH', 'ASSAM', 'BIHAR',
       'CHHATTISGARH', 'JHARKHAND', 'MEGHALAYA', 'MIZORAM', 'NAGALAND',
       'ORISSA', 'SIKKIM', 'UTTRAKHAND', 'A&amp;N ISLAND', 'D&amp;N HAVELI',
       'DAMAN &amp; DIU', 'J &amp; K', 'HIMACHAL PRADESH', 'PUDUCHERRY',
       'ANDAMAN AND NICOBAR', 'ARUNACHAL PRADESH',
       'DADRA AND NAGAR HAVELI', 'DAMAN AND DIU', 'LAKSHADWEEP',
       'TELANGANA', 'TRIPURA', 'UTTARAKHAND', 'A &amp; N ISLAND', 'ODISHA',
       'BALI', 'SULAWESI UTARA', 'DKI JAKARTA',
       'NANGGROE ACEH DARUSSALAM', 'SULAWESI SELATAN',
       'KALIMANTAN SELATAN', 'JAWA BARAT', 'JAMBI', 'RIAU',
       'KALIMANTAN TENGAH', 'SULAWESI TENGAH', 'BENGKULU', 'JAWA TIMUR',
       'JAWA TENGAH', 'PAPUA', 'SUMATERA UTARA', 'KALIMANTAN TIMUR',
       'SULAWESI TENGGARA', 'DI YOGYAKARTA', 'KALIMANTAN BARAT',
       'NUSA TENGGARA TIMUR', 'NUSA TENGGARA BARAT', 'MALUKU',
       'SUMATERA BARAT', 'LAMPUNG', 'SUMATERA SELATAN', 'BANTEN',
       'KEPULAUAN BANGKA BELITUNG', 'GORONTALO', 'MALUKU UTARA',
       'BANGKA BELITUNG', 'DAERAH ISTIMEWA YOGYAKARTA',
       'NANGROE ACEH DARUSSALAM', 'NUSATENGGARA BARAT',
       'NUSATENGGARA TIMUR', 'KEPULAUAN RIAU', 'SULAWESI BARAT',
       'PAPUA BARAT', 'ACEH', 'BABEL', 'D.I YOGYA', 'KALIMANTAN SELATA',
       'SULAWESI SELATA', 'SUMATERA SELATA', 'KEPULAUAN-RIAU',
       'KALIMANTAN UTARA', 'PAPUA BARAT DAYA', 'PAPUA PEGUNUNGAN',
       'PAPUA SELATAN', 'PAPUA TENGAH', 'YAMAGATA', 'AKITA', 'IBARAKI',
       'MIYAGI', 'FUKUSHIMA', 'IWATE', 'GUNMA', 'TOCHIGI', 'HOKKAIDO',
       'SHIGA', 'OKAYAMA', 'OKINAWA', 'AICHI', 'OSAKA', 'KAGOSHIMA',
       'AOMORI', 'KYOTO', 'SHIMANE', 'MIYAZAKI', 'MIE', 'HYOGO',
       'HIROSHIMA', 'KAGAWA', 'KOCHI', 'FUKUI', 'WAKAYAMA', 'SAGA',
       'OITA', 'CHIBA', 'NAGANO', 'TOKUSHIMA', 'FUKUOKA', 'KUMAMOTO',
       'SAITAMA', 'GIFU', 'NARA', 'TOTTORI', 'YAMAGUCHI', 'EHIME',
       'NAGASAKI', 'SHIZUOKA', 'NIIGATA', 'ISHIKAWA', 'YAMANASHI',
       'KANAGAWA', 'TOKYO', 'TOYAMA', 'LOUANGPHABANG', 'ATTAPU', 'BOKEO',
       'BOLIKHAMXAI', 'CHAMPASAK', 'HOUAPHAN', 'KHAMMOUAN',
       'LOUANG-NAMTHA', 'OUDOMXAI', 'PHONGSALI', 'SALAVAN', 'SAVANNAKHET',
       'VIENTIANE CAPITAL', 'VIENTIANE CAPITAL [PREFECTURE]',
       'XAIGNABOULI', 'XAISOMBOUN', 'XEKONG', 'XIANGKHOUANG', 'JOHOR',
       'KELANTAN', 'NEGERI SEMBILAN', 'PAHANG', 'PERLIS', 'PULAU PINANG',
       'SELANGOR', 'PERAK', 'SARAWAK', 'SABAH', 'MELAKA', 'KUALA LUMPUR',
       'TERENGGANU', 'KEDAH', 'LABUAN', 'W.P. KUALA LUMPUR',
       'W.P. LABUAN', 'AGUASCALIENTES', 'BAJA CALIFORNIA',
       'BAJA CALIFORNIA SUR', 'CAMPECHE', 'COAHUILA', 'COLIMA', 'CHIAPAS',
       'CHIHUAHUA', 'DURANGO', 'GUANAJUATO', 'GUERRERO', 'HIDALGO',
       'JALISCO', 'MEXICO', 'MICHOACAN', 'MORELOS', 'NAYARIT',
       'NUEVO LEON', 'OAXACA', 'PUEBLA', 'QUERETARO', 'QUINTANA ROO',
       'SAN LUIS POTOSI', 'SINALOA', 'SONORA', 'TABASCO', 'TAMAULIPAS',
       'TLAXCALA', 'VERACRUZ', 'YUCATAN', 'ZACATECAS', 'AYEYARWADY',
       'BAGO (EAST)', 'BAGO (WEST)', 'KACHIN', 'KAYAH', 'KAYIN', 'MAGWAY',
       'MANDALAY', 'MON', 'NAY PYI TAW', 'RAKHINE', 'SAGAING',
       'SHAN (EAST)', 'SHAN (NORTH)', 'SHAN (SOUTH)', 'TANINTHARYI',
       'YANGON', 'CHIN', 'AYAYARWADDY', 'SHAN (N)', 'BAGO (W', 'SHAN (S)',
       'NAYPYITAW', 'BAGO (E)', 'GANDAKI', 'KARNALI', 'LUMBINI',
       'PROVINCE 1', 'MADHESH', 'BAGMATI', 'SUDURPASCHIM',
       'SUDURPASCHIM PROVINCE', 'LUMBINI PROVINCE', 'GANDAKI PROVINCE',
       'MADHESH PROVINCE', 'BAGMATI PROVINCE', 'KOSHI PROVINCE',
       'KARNALI PROVINCE', 'SUDUR PASHCHIM PROVINCE', 'BOACO', 'CARAZO',
       'CHINANDEGA', 'CHONTALES', 'ESTELI', 'GRANADA', 'JINOTEGA', 'LEON',
       'MADRIZ', 'MANAGUA', 'MASAYA', 'MATAGALPA', 'NUEVA SEGOVIA',
       'RIO SAN JUAN', 'RIVAS', 'BILWI',
       'REGION AUTONOMA DEL ATLANTICO SUR', 'ZELAYA CENTRAL', 'SINDH',
       'KPK', 'TDS-KP', 'AJK', 'ICT', 'BALUCH', 'GILGIT BALTISTAN',
       'BALOCHISTAN', 'KHYBER PAKHTUNKHWA', 'NGARCHELONG', 'NGCHESAR',
       'PELELIU', 'NGAREMLENGUI', 'NGARDMAU', 'NGATPANG', 'AIMELIIK',
       'AIRAI', 'NGARAARD', 'KOROR', 'MELEKEOK', 'KAYANGEL', 'NGIWAL',
       'BOCAS DEL TORO', 'CHIRIQUI', 'COCLE', 'COLON', 'DARIEN',
       'HERRERA', 'KUNA YALA', 'LOS SANTOS', 'VERAGUAS', 'NGOBE BUGLE',
       'PANAMA', 'LORETO', 'PIURA', 'SAN MARTIN', 'TUMBES', 'UCAYALI',
       'CAJAMARCA', 'JUNIN', 'MADRE DE DIOS', 'HUANUCO', 'LAMBAYEQUE',
       'ANCASH', 'LIMA', 'CUSCO', 'PASCO', 'APURIMAC', 'AREQUIPA',
       'AYACUCHO', 'CALLAO', 'HUANCAVELICA', 'ICA', 'MOQUEGUA', 'PUNO',
       'TACNA', 'CALABARZON (REGION IV-A)',
       'EASTERN VISAYAS (REGION VIII)',
       'AUTONOMOUS REGION IN MUSLIM MINDANAO (ARMM)', 'BICOL (REGION V)',
       'CAGAYAN VALLEY (REGION II)', 'CENTRAL LUZON (REGION III)',
       'CENTRAL VISAYAS (REGION VII)', 'DAVAO (REGION XI)',
       'NATIONAL CAPITAL REGION (NCR)', 'NORTHERN MINDANAO (REGION X)',
       'WESTERN VISAYAS (REGION VI)', 'ILOCOS (REGION I)',
       'SOCCSKSARGEN (REGION XII)', 'CARAGA (REGION XIII)',
       'CORDILLERA ADMINISTRATIVE REGION (CAR)',
       'ZAMBOANGA PENINSULA (REGION IX)', 'REGION VI (WESTERN VISAYAS)',
       'REGION IX (ZAMBOANGA PENINSULA)', 'REGION XII (SOCCSKSARGEN)',
       'REGION XIII (CARAGA)', 'REGION 4', 'REGION X (NORTHERN MINDANAO)',
       'REGION I (ILOCOS REGION)', 'REGION II (CAGAYAN VALLEY)',
       'REGION VIII (EASTERN VISAYAS)', 'REGION XI (DAVAO REGION)',
       'REGION V (BICOL REGION)', 'REGION VII (CENTRAL VISAYAS)',
       'REGION III (CENTRAL LUZON)', 'MIMAROPA (REGION IV-B)',
       'REGION IV-B (MIMAROPA)',
       'BANGSAMORO AUTONOMOUS REGION IN MUSLIM MINDANAO (BARMM)',
       'REGION CARAGA (CARAGA)', 'REGION IV-A (CALABARZON)', 'JEDDAH',
       'RIYADH', 'MEDINAH', 'TA`IF', 'HA`IL', 'NORTHERN', 'MAKKAH',
       'QASEEM', 'BISHAH', 'TABOUK', 'JAZAN', 'NAJRAN', 'AL-BAHAH',
       'AL-JOUF', 'QURAYYAT', 'EASTERN', 'AL-AHSA', 'HAFR AL-BATEN',
       'ASEER', 'QUNFUDAH', 'MEDINA', "HA'IL", 'TABUK', 'AHSA', 'GONFUDA',
       'BAHA', 'QASSIM', 'AL-SHAMAL', 'GORIAT', 'MADINAH',
       'HAFR AL-BATIN', 'HAIL', 'JIZAN', 'BISHA', 'TAIF', 'ASIR',
       'THE HOLY CAPITAL', 'NORTHERN BORDERS', 'CENTRAL SINGAPORE',
       'GUADALCANAL', 'HONIARA', 'MAKIRA', 'WESTERN', 'ISABEL',
       'CHOISEUL', 'CENTRAL ISLANDS', 'MALAITA', 'TEMOTU',
       'NORTH CENTRAL', 'CENTRAL', 'UVA', 'NORTH WESTERN', 'SABARAGAMUWA',
       'SOUTHERN', 'PINGTUNG COUNTY', 'KAOHSIUNG CITY', 'NEW TAIPEI CITY',
       'YILAN COUNTY', 'TAIPEI CITY', 'NANTOU COUNTY', 'TAOYUAN CITY',
       'TAICHUNG CITY', 'HSINCHU CITY', 'TAINAN CITY', 'CHANGHUA COUNTY',
       'TAITUNG COUNTY', 'CHIAYI COUNTY', 'HUALIEN COUNTY',
       'PENGHU COUNTY', 'CHIAYI CITY', 'LIENCHIANG COUNTY',
       'YUNLIN COUNTY', 'KEELUNG CITY', 'MIAOLI COUNTY', 'HSINCHU COUNTY',
       'KINMEN COUNTY', 'NARATHIWAT', 'CHIANG RAI',
       'PHRA NAKHON SI AYUDHYA', 'CHACHOENGSAO', 'CHONBURI',
       'PATHUM THANI', 'KHON KAEN', 'SINGBURI', 'PHATTHALUNG', 'KRABI',
       'SONGKHLA', 'LAMPANG', 'LOEI', 'SURAT THANI', 'LOPBURI',
       'SUPHANBURI', 'MAHA SARAKHAM', 'ANG THONG', 'TRANG', 'BANGKOK',
       'NAKHON NAYOK', 'BURIRAM', 'NONG KHAI', 'NAKHON PHANOM', 'RANONG',
       'CHAINAT', 'NAKHON RATCHASIMA', 'UTTARADIT', 'NAKHON SAWAN',
       'CHAIYAPHUM', 'CHANTHABURI', 'ROI ET', 'NAN', 'CHIANG MAI',
       'SAKON NAKHON', 'KALASIN', 'SAMUT PRAKARN', 'LAMPHUN', 'CHUMPHON',
       'NONTHABURI', 'KAMPAENG PHET', 'SATUN', 'KANCHANABURI',
       'PHETCHABURI', 'TRAD', 'PHANGNGA', 'PHAYAO', 'NAKHON PATHOM',
       'PHICHIT', 'SURIN', 'MAE HONG SON', 'TAK', 'PHRAE', 'SUKHOTHAI',
       'PHUKET', 'PHETCHABUN', 'UDON THANI', 'NAKHON SI THAMMARAT',
       'RATCHABURI', 'RAYONG', 'SAMUT SAKHON', 'SAMUT SONGKHAM',
       'SARABURI', 'PATTANI', 'YALA', 'SI SAKET', 'UTHAI THANI',
       'PRACHUAP KHILIKHAN', 'PHITSANULOK', 'YASOTHON',
       'UBON RATCHATHANI', 'PRACHIN BURI', 'MUKDAHAN', 'PHACHINBURI',
       'SA KAEO', 'NONG BUA LAMPHU', 'AMNAT CHAROEN', 'BUNGKAN',
       'LIQUICA', 'MANATUTO', 'MANUFAHI', 'VIQUEQUE', 'BAUCAU',
       'BOBONARO', 'DILI', 'ERMERA', 'LAUTEM', 'OECUSSI', 'AINARO',
       'AILEU', 'COVALIMA', 'TONGATAPU', 'HAAPAI', "VAVA'U", 'ALABAMA',
       'CALIFORNIA', 'COLORADO', 'GEORGIA', 'ILLINOIS', 'INDIANA',
       'MAINE', 'MASSACHUSETTS', 'MICHIGAN', 'MINNESOTA', 'MISSOURI',
       'PENNSYLVANIA', 'SOUTH CAROLINA', 'TEXAS', 'CONNECTICUT',
       'KENTUCKY', 'NEW HAMPSHIRE', 'NEW JERSEY', 'OHIO', 'WISCONSIN',
       'NEBRASKA', 'NEW MEXICO', 'NEW YORK', 'OREGON', 'TENNESSEE',
       'UTAH', 'VERMONT', 'FLORIDA', 'NORTH CAROLINA', 'WEST VIRGINIA',
       'MONTANA', 'WASHINGTON', 'MARYLAND', 'ARKANSAS', 'DELAWARE',
       'KANSAS', 'NEVADA', 'OKLAHOMA', 'DISTRICT OF COLUMBIA', 'HAWAII',
       'VIRGINIA', 'ALASKA', 'CARABOBO', 'DELTA AMACURO',
       'DISTRITO CAPITAL', 'FALCON', 'GUARICO', 'LARA', 'MERIDA',
       'MIRANDA', 'MONAGAS', 'NUEVA ESPARTA', 'PORTUGUESA', 'TACHIRA',
       'TRUJILLO', 'YARACUY', 'ZULIA', 'ANZOATEGUI', 'APURE', 'ARAGUA',
       'BARINAS', 'COJEDES', 'BAC GIANG', 'NAM DINH', 'AN GIANG',
       'GIA LAI', 'LAO CAI', 'SOC TRANG', 'SON LA', 'THAI BINH',
       'HA NOI CITY', 'CAN THO CITY', 'DONG NAI', 'HA TAY', 'HA TINH',
       'HAI PHONG CITY', 'KHANH HOA', 'NINH THUAN', 'LAI CHAU',
       'TAY NINH', 'THANH HOA', 'NINH BINH', 'BINH DINH', 'BINH THUAN',
       'PHU YEN', 'QUANG NAM', 'QUANG NGAI', 'QUANG NINH', 'QUANG TRI',
       'BINH DUONG', 'VINH LONG', 'CA MAU', 'CAO BANG', 'KIEN GIANG',
       'THAI NGUYEN', 'HO CHI MINH CITY', 'THUA THIEN - HUE', 'DONG THAP',
       'LANG SON', 'HAI DUONG', 'TUYEN QUANG', 'HA GIANG', 'BEN TRE',
       'NGHE AN', 'VINH PHUC', 'TRA VINH', 'YEN BAI', 'DAK LAK',
       'TIEN GIANG', 'KON TUM', 'QUANG BINH', 'LAM DONG', 'LONG AN',
       'HOA BINH', 'BA RIA-VUNG TAU', 'DA NANG CITY', 'HA NAM',
       'BAC NINH', 'BAC KAN', 'BINH PHUOC', 'PHU THO', 'BAC LIEU',
       'HUNG YEN', 'DIEN BIEN', 'HAU GIANG', 'DAK NONG'], dtype=object)</code></pre>
</div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>